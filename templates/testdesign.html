<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Productos - Byte & Beat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .sidebar-nav a {
            transition: all 0.2s ease;
        }
        .sidebar-nav a:hover {
            background-color: rgba(55, 65, 81, 0.8);
        }
        .sidebar-nav a.active {
            background-color: #2563eb;
        }
        
        .table-hover:hover {
            background-color: #f9fafb;
        }
        
        .modal-overlay {
            backdrop-filter: blur(4px);
        }
        
        .status-badge {
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .stat-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .product-image {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 8px;
        }

        .action-button {
            transition: all 0.2s ease;
        }

        .action-button:hover {
            transform: scale(1.1);
        }

        .stock-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 4px;
        }

        .stock-high { background-color: #10b981; }
        .stock-medium { background-color: #f59e0b; }
        .stock-low { background-color: #ef4444; }
        .stock-out { background-color: #6b7280; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Sidebar -->
    <div class="fixed left-0 top-0 w-48 h-full bg-gray-800 text-white z-40">
        <div class="p-4">
            <div class="flex items-center space-x-2 mb-8">
                <div class="w-8 h-8 bg-blue-600 rounded flex items-center justify-center">
                    <span class="text-xs font-bold">BB</span>
                </div>
                <span class="font-medium text-sm">Byte & Beat</span>
            </div>
            
            <nav class="space-y-2 sidebar-nav">
                <a href="#" class="flex items-center space-x-2 p-2 rounded">
                    <span>🏠</span>
                    <span class="text-sm">Inicio</span>
                </a>
                <a href="#" class="flex items-center space-x-2 p-2 rounded">
                    <span>📦</span>
                    <span class="text-sm">Gestión de Pedidos</span>
                </a>
                <a href="#" class="flex items-center space-x-2 p-2 rounded active">
                    <span>🛍</span>
                    <span class="text-sm">Gestión de Productos</span>
                </a>
                <a href="#" class="flex items-center space-x-2 p-2 rounded">
                    <span>📊</span>
                    <span class="text-sm">Reportes de Ventas</span>
                </a>
                <a href="#" class="flex items-center space-x-2 p-2 rounded">
                    <span>📈</span>
                    <span class="text-sm">Dashboard</span>
                </a>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-48 p-6">
        <!-- Header -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-6 text-white mb-6">
            <h1 class="text-2xl font-bold mb-2">Gestión de Productos</h1>
            <p class="opacity-90">Administra y supervisa todo tu inventario de productos</p>
            <p class="text-sm opacity-75 mt-2">Hoy es viernes, 13 de junio de 2025</p>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
            <div class="bg-white rounded-lg p-6 shadow-sm border stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">Total Productos</p>
                        <h3 class="text-2xl font-bold text-gray-900" id="total-products">8</h3>
                        <p class="text-sm text-green-600 mt-1">+12% desde el mes pasado</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm border stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">Productos Activos</p>
                        <h3 class="text-2xl font-bold text-gray-900" id="active-products">6</h3>
                        <p class="text-sm text-green-600 mt-1">+8% desde el mes pasado</p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm border stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">Stock Bajo</p>
                        <h3 class="text-2xl font-bold text-gray-900" id="low-stock">2</h3>
                        <p class="text-sm text-red-600 mt-1">Requiere atención</p>
                    </div>
                    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.664-.833-2.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg p-6 shadow-sm border stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">Valor Inventario</p>
                        <h3 class="text-2xl font-bold text-gray-900" id="inventory-value">$58,750</h3>
                        <p class="text-sm text-green-600 mt-1">+18% desde el mes pasado</p>
                    </div>
                    <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="bg-white rounded-lg p-6 shadow-sm border mb-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="relative">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input
                        type="text"
                        id="search-sku"
                        placeholder="Buscar por SKU..."
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                </div>
                
                <div class="relative">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                    </svg>
                    <select
                        id="filter-brand"
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white"
                    >
                        <option value="todas">Todas las marcas</option>
                        <option value="Apple">Apple</option>
                        <option value="Samsung">Samsung</option>
                        <option value="Sony">Sony</option>
                        <option value="Nike">Nike</option>
                        <option value="Adidas">Adidas</option>
                    </select>
                </div>

                <div class="relative">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    <select
                        id="filter-category"
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white"
                    >
                        <option value="todas">Todas las categorías</option>
                        <option value="Electrónicos">Electrónicos</option>
                        <option value="Ropa">Ropa</option>
                        <option value="Deportes">Deportes</option>
                        <option value="Hogar">Hogar</option>
                    </select>
                </div>

                <div class="relative">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <select
                        id="filter-status"
                        class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white"
                    >
                        <option value="todos">Todos los estados</option>
                        <option value="Activo">Activo</option>
                        <option value="Inactivo">Inactivo</option>
                    </select>
                </div>
            </div>

            <div class="mt-4 flex justify-between items-center">
                <button 
                    id="clear-filters"
                    class="px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"
                >
                    Limpiar Filtros
                </button>
                <button 
                    id="add-product"
                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    <span>Agregar Producto</span>
                </button>
            </div>
        </div>

        <!-- Products Table -->
        <div class="bg-white rounded-lg shadow-sm border">
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-200 bg-gray-50">
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">SKU</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Producto</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Precio</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Marca</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Categoría</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Stock</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Estado</th>
                            <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="products-table-body" class="divide-y divide-gray-200">
                        <!-- Products will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div id="no-products" class="text-center py-12 hidden">
                <svg class="w-12 h-12 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                </svg>
                <p class="text-gray-500">No se encontraron productos que coincidan con los filtros.</p>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal-overlay">
        <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Detalle del Producto</h2>
                <button 
                    id="close-modal"
                    class="text-gray-400 hover:text-gray-600 text-2xl"
                >
                    ×
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Product Image -->
                <div class="space-y-4">
                    <div class="w-full h-64 bg-gray-100 rounded-lg flex items-center justify-center">
                        <img id="modal-product-image" src="" alt="" class="max-w-full max-h-full object-contain rounded-lg">
                    </div>
                </div>
                
                <!-- Product Details -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">SKU</label>
                        <p class="text-lg font-semibold text-gray-900" id="modal-sku"></p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nombre del Producto</label>
                        <p class="text-lg text-gray-900" id="modal-name"></p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Precio</label>
                            <p class="text-lg font-semibold text-green-600" id="modal-price"></p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Stock</label>
                            <p class="text-lg text-gray-900" id="modal-stock"></p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Marca</label>
                            <p class="text-lg text-gray-900" id="modal-brand"></p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
                            <p class="text-lg text-gray-900" id="modal-category"></p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Estado</label>
                        <select 
                            id="modal-status"
                            class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="Activo">Activo</option>
                            <option value="Inactivo">Inactivo</option>
                        </select>
                    </div>
                    
                    <div class="pt-4 flex space-x-3">
                        <button 
                            id="modal-edit"
                            class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
                        >
                            Editar Producto
                        </button>
                        <button 
                            id="modal-delete"
                            class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors"
                        >
                            Eliminar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample products data
        const products = [
            {
                sku: 'IPH001',
                nombre: 'iPhone 15 Pro Max',
                precio: 1299.99,
                marca: 'Apple',
                categoria: 'Electrónicos',
                stock: 25,
                imagen: 'https://images.unsplash.com/photo-1592899677977-9c10ca588bbd?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'SAM002',
                nombre: 'Samsung Galaxy S24 Ultra',
                precio: 1199.99,
                marca: 'Samsung',
                categoria: 'Electrónicos',
                stock: 18,
                imagen: 'https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'SON003',
                nombre: 'Sony WH-1000XM5',
                precio: 399.99,
                marca: 'Sony',
                categoria: 'Electrónicos',
                stock: 45,
                imagen: 'https://images.unsplash.com/photo-1583394838336-acd977736f90?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'NIK004',
                nombre: 'Nike Air Max 270',
                precio: 149.99,
                marca: 'Nike',
                categoria: 'Deportes',
                stock: 8,
                imagen: 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'ADI005',
                nombre: 'Adidas Ultraboost 22',
                precio: 189.99,
                marca: 'Adidas',
                categoria: 'Deportes',
                stock: 32,
                imagen: 'https://images.unsplash.com/photo-1549298916-b41d501d3772?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'APL006',
                nombre: 'MacBook Air M2',
                precio: 1199.99,
                marca: 'Apple',
                categoria: 'Electrónicos',
                stock: 12,
                imagen: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=300&h=300&fit=crop',
                estado: 'Activo'
            },
            {
                sku: 'SON007',
                nombre: 'Sony PlayStation 5',
                precio: 499.99,
                marca: 'Sony',
                categoria: 'Electrónicos',
                stock: 3,
                imagen: 'https://images.unsplash.com/photo-1606813907291-d86efa9b94db?w=300&h=300&fit=crop',
                estado: 'Inactivo'
            },
            {
                sku: 'NIK008',
                nombre: 'Nike Dri-FIT Shirt',
                precio: 29.99,
                marca: 'Nike',
                categoria: 'Ropa',
                stock: 0,
                imagen: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=300&h=300&fit=crop',
                estado: 'Inactivo'
            }
        ];

        const statusColors = {
            'Activo': 'text-green-600 bg-green-100',
            'Inactivo': 'text-red-600 bg-red-100'
        };

        let filteredProducts = [...products];
        let selectedProduct = null;

        // DOM elements
        const searchSku = document.getElementById('search-sku');
        const filterBrand = document.getElementById('filter-brand');
        const filterCategory = document.getElementById('filter-category');
        const filterStatus = document.getElementById('filter-status');
        const clearFiltersBtn = document.getElementById('clear-filters');
        const addProductBtn = document.getElementById('add-product');
        const productsTableBody = document.getElementById('products-table-body');
        const noProductsMessage = document.getElementById('no-products');
        const productModal = document.getElementById('product-modal');
        const closeModalBtn = document.getElementById('close-modal');

        // Initialize the page
        function init() {
            updateStats();
            renderProducts();
            setupEventListeners();
        }

        // Update statistics
        function updateStats() {
            const totalProducts = products.length;
            const activeProducts = products.filter(p => p.estado === 'Activo').length;
            const lowStockProducts = products.filter(p => p.stock <= 10 && p.stock > 0).length;
            const inventoryValue = products.reduce((sum, product) => sum + (product.precio * product.stock), 0);

            document.getElementById('total-products').textContent = totalProducts;
            document.getElementById('active-products').textContent = activeProducts;
            document.getElementById('low-stock').textContent = lowStockProducts;
            document.getElementById('inventory-value').textContent = '$' + inventoryValue.toLocaleString();
        }

        // Get stock indicator
        function getStockIndicator(stock) {
            if (stock === 0) return '<span class="stock-indicator stock-out"></span>Sin stock';
            if (stock <= 5) return '<span class="stock-indicator stock-low"></span>' + stock;
            if (stock <= 15) return '<span class="stock-indicator stock-medium"></span>' + stock;
            return '<span class="stock-indicator stock-high"></span>' + stock;
        }

        // Render products table
        function renderProducts() {
            if (filteredProducts.length === 0) {
                productsTableBody.innerHTML = '';
                noProductsMessage.classList.remove('hidden');
                return;
            }

            noProductsMessage.classList.add('hidden');
            
            productsTableBody.innerHTML = filteredProducts.map(product => `
                <tr class="table-hover">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${product.sku}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <img class="product-image mr-3" src="${product.imagen}" alt="${product.nombre}" onerror="this.src='https://via.placeholder.com/50x50?text=IMG'">
                            <div class="text-sm text-gray-900">${product.nombre}</div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-green-600">$${product.precio.toLocaleString()}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${product.marca}</div>
                    </td>
                    
<td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${product.categoria}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${getStockIndicator(product.stock)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium status-badge ${statusColors[product.estado]}">
                            ${product.estado}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex space-x-2">
                            <button 
                                onclick="viewProduct('${product.sku}')"
                                class="text-blue-600 hover:text-blue-800 action-button"
                                title="Ver detalles"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                            <button 
                                onclick="editProduct('${product.sku}')"
                                class="text-green-600 hover:text-green-800 action-button"
                                title="Editar"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button 
                                onclick="deleteProduct('${product.sku}')"
                                class="text-red-600 hover:text-red-800 action-button"
                                title="Eliminar"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Filter products
        function filterProducts() {
            const skuFilter = searchSku.value.toLowerCase();
            const brandFilter = filterBrand.value;
            const categoryFilter = filterCategory.value;
            const statusFilter = filterStatus.value;

            filteredProducts = products.filter(product => {
                const matchesSku = product.sku.toLowerCase().includes(skuFilter) || 
                                 product.nombre.toLowerCase().includes(skuFilter);
                const matchesBrand = brandFilter === 'todas' || product.marca === brandFilter;
                const matchesCategory = categoryFilter === 'todas' || product.categoria === categoryFilter;
                const matchesStatus = statusFilter === 'todos' || product.estado === statusFilter;

                return matchesSku && matchesBrand && matchesCategory && matchesStatus;
            });

            renderProducts();
        }

        // Clear all filters
        function clearFilters() {
            searchSku.value = '';
            filterBrand.value = 'todas';
            filterCategory.value = 'todas';
            filterStatus.value = 'todos';
            filteredProducts = [...products];
            renderProducts();
        }

        // View product details
        function viewProduct(sku) {
            selectedProduct = products.find(p => p.sku === sku);
            if (!selectedProduct) return;

            // Populate modal with product data
            document.getElementById('modal-sku').textContent = selectedProduct.sku;
            document.getElementById('modal-name').textContent = selectedProduct.nombre;
            document.getElementById('modal-price').textContent = '$' + selectedProduct.precio.toLocaleString();
            document.getElementById('modal-stock').textContent = selectedProduct.stock;
            document.getElementById('modal-brand').textContent = selectedProduct.marca;
            document.getElementById('modal-category').textContent = selectedProduct.categoria;
            document.getElementById('modal-status').value = selectedProduct.estado;
            document.getElementById('modal-product-image').src = selectedProduct.imagen;
            document.getElementById('modal-product-image').alt = selectedProduct.nombre;

            // Show modal
            productModal.classList.remove('hidden');
        }

        // Edit product
        function editProduct(sku) {
            // In a real application, this would open an edit form
            alert(Funcionalidad de edición para el producto ${sku} - Esta funcionalidad se implementaría en una versión completa del sistema.);
        }

        // Delete product
        function deleteProduct(sku) {
            if (confirm(¿Estás seguro de que deseas eliminar el producto ${sku}?)) {
                const index = products.findIndex(p => p.sku === sku);
                if (index > -1) {
                    products.splice(index, 1);
                    filterProducts();
                    updateStats();
                    alert('Producto eliminado exitosamente');
                }
            }
        }

        // Close modal
        function closeModal() {
            productModal.classList.add('hidden');
            selectedProduct = null;
        }

        // Update product status from modal
        function updateProductStatus() {
            if (!selectedProduct) return;

            const newStatus = document.getElementById('modal-status').value;
            selectedProduct.estado = newStatus;

            // Update the product in the main array
            const productIndex = products.findIndex(p => p.sku === selectedProduct.sku);
            if (productIndex > -1) {
                products[productIndex].estado = newStatus;
            }

            // Refresh the table and stats
            filterProducts();
            updateStats();
        }

        // Add new product
        function addProduct() {
            // In a real application, this would open an add product form
            alert('Funcionalidad para agregar producto - Esta funcionalidad se implementaría con un formulario completo en una versión real del sistema.');
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search and filter inputs
            searchSku.addEventListener('input', filterProducts);
            filterBrand.addEventListener('change', filterProducts);
            filterCategory.addEventListener('change', filterProducts);
            filterStatus.addEventListener('change', filterProducts);

            // Clear filters button
            clearFiltersBtn.addEventListener('click', clearFilters);

            // Add product button
            addProductBtn.addEventListener('click', addProduct);

            // Modal controls
            closeModalBtn.addEventListener('click', closeModal);
            
            // Close modal when clicking outside
            productModal.addEventListener('click', (e) => {
                if (e.target === productModal) {
                    closeModal();
                }
            });

            // Modal buttons
            document.getElementById('modal-edit').addEventListener('click', () => {
                if (selectedProduct) {
                    editProduct(selectedProduct.sku);
                }
            });

            document.getElementById('modal-delete').addEventListener('click', () => {
                if (selectedProduct) {
                    deleteProduct(selectedProduct.sku);
                    closeModal();
                }
            });

            // Update status when changed in modal
            document.getElementById('modal-status').addEventListener('change', updateProductStatus);

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Escape key to close modal
                if (e.key === 'Escape' && !productModal.classList.contains('hidden')) {
                    closeModal();
                }

                // Ctrl+F to focus search
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    searchSku.focus();
                }
            });
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);

        // Export functions for global access (if needed)
        window.viewProduct = viewProduct;
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
    </script>
</body>

<script>
    function eliminarProducto(id){
        const baseUrl = "{% url 'eliminar_product_admin' 0 %}".replace("0", id);
        Swal.fire({
            title: '¿Estás seguro?',
            text: 'Esta acción no se puede deshacer',
            icon: 'question',
            showCancelButton: true,
            cancelButtonText: 'No, cancelar',
            confirmButtonText: 'Sí, eliminar',
            reverseButtons: true,
            confirmButtonColor: '#dc3545'
        }).then(function(result){
            if(result.isConfirmed){
                window.location.href = baseUrl;
            }
        });
    }
</script>