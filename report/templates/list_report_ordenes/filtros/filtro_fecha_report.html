<form action="{% url 'orden_list_filter' %}" method="GET" class="flex flex-col md:flex-row gap-4 items-center w-full">
    <!-- Filtro por fecha de inicio -->
    <div class="flex flex-col md:flex-row gap-2 items-center w-full md:w-1/3 mr-4">
        <label for="fecha_inicio" class="text-sm font-semibold">Desde:</label>
        <input type="date" name="fecha_inicio" id="fecha_inicio" value="{{ fecha_inicio }}" class="border border-gray-300 rounded-lg p-2 w-full md:w-auto">
    </div>

    <!-- Filtro por fecha de fin -->
    <div class="flex flex-col md:flex-row gap-2 items-center w-full md:w-1/3">
        <label for="fecha_fin" class="text-sm font-semibold">Hasta:</label>
        <input type="date" name="fecha_fin" id="fecha_fin" value="{{ fecha_fin }}" class="border border-gray-300 rounded-lg p-2 w-full md:w-auto">
    </div>

    <!-- Botón Filtrar -->
    <div class="w-full md:w-1/3 flex justify-center md:justify-start mt-4 md:mt-0">
        <button type="submit" id="submitform" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg shadow-md transition-all duration-300 ease-in-out w-full md:w-auto">
            Filtrar
        </button>
    </div>

    <!-- Botón Borrar filtro -->
    {% if fecha_inicio or fecha_fin %}
        <div class="w-full md:w-1/3 flex justify-center md:justify-start mt-4 md:mt-0">
            <button type="submit" name="borrarFiltro" value="true" id="borrarfiltro" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg shadow-md transition-all duration-300 ease-in-out w-full md:w-auto">
                Borrar filtro
            </button>
        </div>
    {% endif %}
</form>

<script>
    const fechainicio = document.getElementById('fecha_inicio');
    const fechafin = document.getElementById('fecha_fin');
    const submitform = document.getElementById('submitform');
    const borrarfiltro = document.getElementById('borrarfiltro');

    if (borrarfiltro) {
        borrarfiltro.addEventListener('click', function(event) {
            fechainicio.value = '';
            fechafin.value = '';
        });
    }

    function compararFechas() {
        const fecha1 = fechainicio.value;
        const fecha2 = fechafin.value;

        if (fecha1 && fecha2) {
            if (fecha1 > fecha2) {
                event.preventDefault(); 
                submitform.disabled = true;
                console.log('⚠️ La fecha de inicio es mayor a la de fin');
                Swal.fire({
                    title: 'Fecha incorrecta',
                    text: 'La fecha de inicio es mayor a la de fin, debe elegir otro rango de fechas',
                    icon: 'warning',
                    confirmButtonText: 'Ok',
                    reverseButtons: true,
                    confirmButtonColor: '#dc3545',
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                }).then(function(result){
                    if(result.isConfirmed){
                        fechainicio.value = '';
                        fechafin.value = '';
                        submitform.disabled = false;
                    }
                });
            } else {
                console.log('✅ La fecha de inicio está correcta');
            }
        }
    }

    fechainicio.addEventListener('change', compararFechas);
    fechafin.addEventListener('change', compararFechas);
</script>
